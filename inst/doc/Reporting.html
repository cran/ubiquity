<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Report Generation</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<style type="text/css">.tabwid {
font-size: initial;
padding-bottom: 1em;
}
.tabwid table{
border-spacing:0px !important;
border-collapse:collapse;
line-height:1;
margin-left:auto;
margin-right:auto;
border-width: 0;
border-color: transparent;
caption-side: top;
}
.tabwid-caption-bottom table{
caption-side: bottom;
}
.tabwid_left table{
margin-left:0;
}
.tabwid_right table{
margin-right:0;
}
.tabwid td, .tabwid th {
padding: 0;
}
.tabwid a {
text-decoration: none;
}
.tabwid thead {
background-color: transparent;
}
.tabwid tfoot {
background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
margin: 0 0 !important;
}
</style>
<script>document.addEventListener("DOMContentLoaded", function(event) {
  var els = document.querySelectorAll(".tabwid");
  var tabwid_link = document.querySelector('link[href*="tabwid.css"]')
  if (tabwid_link === null) {
    const tabwid_styles = document.evaluate("//style[contains(., 'tabwid')]", document, null, XPathResult.ANY_TYPE, null );
    tabwid_link = tabwid_styles.iterateNext();
  }

  Array.prototype.forEach.call(els, function(template) {
      const dest = document.createElement("div");
      template.parentNode.insertBefore(dest, template.nextSibling)
      dest.setAttribute("class", "flextable-shadow-host");
      const fantome = dest.attachShadow({mode: 'open'});
      fantome.appendChild(template);
      if (tabwid_link !== null) {
        fantome.appendChild(tabwid_link.cloneNode(true));
      }
  });
});

</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Report Generation</h1>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Reporting is implemented using the <code>onbrand</code> package which
is a templated interface to the <code>officer</code> package. Officer
provides a lot of control over the generation of both Word and
PowerPoint documents. If you feel comfortable programming in R, you may
wan to use that package directly. However the templated workflow in
<code>onbrand</code> facilitates switching between organizational
templates. Currently <code>ubiquity</code> has support for generating
both PowerPoint and Word reports, and this vignette will go over example
scripts for both types of reports.</p>
<div id="implenting-onbrand-in-ubiquity" class="section level3">
<h3>Implenting <code>onbrand</code> in <code>ubiquity</code></h3>
<p>One objective of reporting in <code>ubiquity</code> is to allow the
management of several reports simultaneously. This is done by creating
wrapper functions for functions in <code>onbrand</code>. Where the
<code>onbrand</code> functions take in an <code>onbrand</code> object,
the wrapper functions take in a <code>ubiquity</code> system object and
an optional report name (<code>rptname</code>). The other inputs to the
<code>ubiquty</code> wrapper functions are passed through directly to
the wrapped <code>onbrand</code> function. At the bottom of this
vignette, the <code>ubiquity</code> function name is listed along with
the <code>onbrand</code> name it wraps around.</p>
</div>
<div id="reporting-workshop-files" class="section level3">
<h3>Reporting workshop files</h3>
<p>To make a copy of the example scripts in the current working
directory run the following:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ubiquity)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>fr <span class="ot">=</span> <span class="fu">workshop_fetch</span>(<span class="at">section=</span><span class="st">&quot;Reporting&quot;</span>, <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>This should create the following scripts</p>
<ul>
<li><code>make_report_PowerPoint.R</code> Generates a PowerPoint
presentation from an R script</li>
<li><code>make_report_Word.R</code> Generates a Word document from an R
script</li>
</ul>
<p>Then general process for creating a report is:</p>
<ol style="list-style-type: decimal">
<li>Initialize a report using the function
<code>system_rpt_read_template()</code>.</li>
<li>Use the functions that add content to reports
(<code>system_rpt_add_slide()</code> for PowerPoint and
<code>system_rpt_add_doc_content()</code> for Word), or append analysis
results using integrated workflow reporting
(e.g. <code>system_rpt_estimation()</code> to add the results of
parameter estimation).</li>
<li>Lastly, save the output using
<code>system_rpt_save_report()</code>.</li>
</ol>
<p>The examples below are intended to work with a <code>ubiquity</code>
system object. So at the top of any script you will need to build the
system. If you don’t have a system file, this command will create an
empty template in the current directory:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">build_system</span>(<span class="st">&quot;system.txt&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="powerpoint-reports-make_report_powerpoint.r" class="section level2">
<h2>PowerPoint reports (<code>make_report_PowerPoint.R</code>)</h2>
<div id="creating-some-content" class="section level3">
<h3>Creating some content</h3>
<p>Before we get started we’ll create some content for the presentation.
Since we’re wrapping around <code>onbrand</code> functions, the content
is expected in a format consistent with those functions. For details on
the format of different content types, see the help for
<code>onbrand::add_pptx_ph_content()</code>.</p>
<p>First we’ll create some figures. First a ggplot object
(<code>p</code>) and an image file (<code>imgfile</code>).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">0</span>, <span class="at">label =</span> <span class="st">&quot;picture example&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>imgfile <span class="ot">=</span> <span class="fu">tempfile</span>(<span class="at">pattern=</span><span class="st">&quot;image&quot;</span>, <span class="at">fileext=</span><span class="st">&quot;.png&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename=</span>imgfile, <span class="at">plot=</span>p, <span class="at">height=</span><span class="fl">5.15</span>, <span class="at">width=</span><span class="dv">9</span>, <span class="at">units=</span><span class="st">&quot;in&quot;</span>)</span></code></pre></div>
<p>Next we’ll create tabular data (<code>tdata</code>):</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>tdata <span class="ot">=</span>  <span class="fu">data.frame</span>(<span class="at">Parameters =</span> <span class="fu">c</span>(<span class="st">&quot;Vp&quot;</span>, <span class="st">&quot;Cl&quot;</span>, <span class="st">&quot;Q&quot;</span>, <span class="st">&quot;Vt&quot;</span>),</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Values     =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Units      =</span> <span class="fu">c</span>(<span class="st">&quot;L&quot;</span>, <span class="st">&quot;L/hr&quot;</span>, <span class="st">&quot;L/hr&quot;</span>, <span class="st">&quot;L&quot;</span>) )</span></code></pre></div>
<p>Tables can be displayed in three different ways: as an Office table,
an <code>onbrand</code> abstraction of a <code>flextable</code>, or a
user defined <code>flextable</code> object. These are lists with
specific elements. You should see the content specifications found in
<code>onbrand::add_pptx_ph_content()</code> for details on how these
lists should be formatted. The examples below should be able to get you
started.</p>
<p><strong>Office table</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>tco  <span class="ot">=</span> <span class="fu">list</span>(<span class="at">table     =</span> tdata,  </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">header    =</span> <span class="cn">TRUE</span>,   </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">first_row =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><strong><code>flextable</code> using <code>onbrand</code>
abstraction</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tcf <span class="ot">=</span> <span class="fu">list</span>(<span class="at">table       =</span> tdata,             <span class="co"># This element contains the table data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">header_top  =</span> <span class="fu">list</span>(              <span class="co"># Defining the table headers</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">Parameters =</span> <span class="st">&quot;Name&quot;</span>,  </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">Values     =</span> <span class="st">&quot;Value&quot;</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">Units      =</span> <span class="st">&quot;Units&quot;</span>),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">cwidth         =</span> <span class="fl">0.8</span>,            <span class="co"># Column width</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">table_autofit  =</span> <span class="cn">TRUE</span>,           <span class="co"># Making the tables automatically fit</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">table_theme    =</span> <span class="st">&quot;theme_zebra&quot;</span>,  <span class="co"># Selecting the table theme</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">first_row =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><strong>User-defined <code>flextable</code> object</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>tfo <span class="ot">=</span> flextable<span class="sc">::</span><span class="fu">flextable</span>(tdata)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>tfo <span class="ot">=</span> flextable<span class="sc">::</span><span class="fu">autofit</span>(tfo)</span></code></pre></div>
<p>Lastly list content is specified in a paired vector. The first
element indicates the indention level, and the second indicates the
content. <strong>Note</strong>: This will only work for placeholders
that contain list content.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>lcontent <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="st">&quot;First major item&quot;</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>             <span class="dv">2</span>, <span class="st">&quot;first sub bullet&quot;</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>             <span class="dv">2</span>, <span class="st">&quot;second sub bullet&quot;</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>             <span class="dv">3</span>, <span class="st">&quot;sub sub bullet&quot;</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>             <span class="dv">1</span>, <span class="st">&quot;Second major item&quot;</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>             <span class="dv">2</span>, <span class="st">&quot;first sub bullet&quot;</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>             <span class="dv">2</span>, <span class="st">&quot;second sub bullet&quot;</span>)</span></code></pre></div>
</div>
<div id="creating-a-new-report" class="section level3">
<h3>Creating a new report</h3>
<p>First we initialize a new report. If the template option is set to
<code>&quot;PowerPoint&quot;</code> it will create an empty presentation using the
internal <code>ubiquity</code> template. Below we discuss creating
custom templates for your organization.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_read_template</span>(cfg, <span class="st">&quot;PowerPoint&quot;</span>)</span></code></pre></div>
</div>
<div id="adding-slides-to-a-report" class="section level3">
<h3>Adding slides to a report</h3>
<p>Slides are added using <code>ubiquity::system_rpt_add_slide()</code>
with the slide template to be used and the elements identifying the
placeholders and the placeholder content. Here we’re adding slides for a
title (<code>&quot;title_slide&quot;</code>) and a section
(<code>&quot;section_side&quot;</code>).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_add_slide</span>(cfg, </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">template =</span> <span class="st">&quot;title_slide&quot;</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">elements =</span> <span class="fu">list</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">title=</span><span class="fu">list</span>(<span class="at">content =</span> <span class="st">&quot;Reporting in ubiquity&quot;</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type    =</span> <span class="st">&quot;text&quot;</span>)))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_add_slide</span>(cfg, </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>   <span class="at">template =</span> <span class="st">&quot;section_slide&quot;</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>   <span class="at">elements =</span> <span class="fu">list</span>(</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">title=</span><span class="fu">list</span>(<span class="at">content =</span> <span class="st">&quot;Content Types&quot;</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type    =</span> <span class="st">&quot;text&quot;</span>)))</span></code></pre></div>
<p>For each element there is a list element (e.g. <code>title</code>)
that contains content and content type. The type specifies whether the
content is a figure, table, etc. In this example we’re using text. There
are two types of text content. One is plain text and the other is lists.
This is determined by the placeholder type in PowerPoint. We’ll go
through examples below for different types of content and available
templates. For details on the format of the <code>template</code> and
<code>elements</code> inputs see the documentation for
<code>onbrand::report_add_slide()</code>. To show the available
templates, placeholder element names in each template, and the type of
text they can hold you can do the following:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fr <span class="ot">=</span> <span class="fu">system_rpt_template_details</span>(cfg)</span></code></pre></div>
<p>This will produce output in the console like the following:</p>
<pre><code>## Mapping:     /Users/jmh/Library/R/x86_64/4.1/library/ubiquity/ubinc/templates/report.yaml
## Report Type: PowerPoint
## title_slide (master/template)
##   &gt; title (text)
##   &gt; sub_title (text)
## section_slide (master/template)
##   &gt; title (text)
##   &gt; sub_title (text)
## title_only (master/template)
##   &gt; title (text)
## content_text (master/template)
##   &gt; title (text)
##   &gt; sub_title (text)
##   &gt; content_body (text)
## content_list (master/template)
##   &gt; title (text)
##   &gt; sub_title (text)
##   &gt; content_body (list)</code></pre>
<div id="adding-lists" class="section level4">
<h4>Adding lists</h4>
<p>In the previous example we added text content, here we will add the
list content we created above (<code>lcontent</code>). Notice that we
simply specify the content type is <code>&quot;list&quot;</code>.
<strong>Note:</strong> You can only do this if the content type is list
in the slide master.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_add_slide</span>(cfg, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">template =</span> <span class="st">&quot;content_list&quot;</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">elements =</span> <span class="fu">list</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">title=</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">content =</span> <span class="st">&quot;Lists&quot;</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">type    =</span> <span class="st">&quot;text&quot;</span>),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">sub_title=</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">content =</span> <span class="st">&quot;For placholders that contain lists.&quot;</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">type    =</span> <span class="st">&quot;text&quot;</span>),</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">content_body=</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">content =</span> lcontent,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">type    =</span> <span class="st">&quot;list&quot;</span>)))</span></code></pre></div>
</div>
<div id="adding-figures" class="section level4">
<h4>Adding figures</h4>
<p>If you specify the content type is <code>&quot;ggplot&quot;</code>, then you
can just provide the ggplot object (<code>p</code>).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_add_slide</span>(cfg, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">template =</span> <span class="st">&quot;content_text&quot;</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">elements =</span> <span class="fu">list</span>(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">title=</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">content =</span> <span class="st">&quot;Figures: ggplot object&quot;</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">type    =</span> <span class="st">&quot;text&quot;</span>),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">sub_title=</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">content =</span> <span class="st">&quot;Using ggplot objects directly&quot;</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">type    =</span> <span class="st">&quot;text&quot;</span>),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">content_body=</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">content =</span> p,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">type    =</span> <span class="st">&quot;ggplot&quot;</span>)))</span></code></pre></div>
<p>If you have an image in a file you want to insert you can use the
<code>&quot;imagefile&quot;</code> content type. One was created above and the
location is stored in the <code>imgfile</code> object.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_add_slide</span>(cfg, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">template =</span> <span class="st">&quot;content_text&quot;</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">elements =</span> <span class="fu">list</span>(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">title=</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">content =</span> <span class="st">&quot;Figures: image file&quot;</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">type    =</span> <span class="st">&quot;text&quot;</span>),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">sub_title=</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">content =</span> <span class="st">&quot;Inserting figures from files&quot;</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">type    =</span> <span class="st">&quot;text&quot;</span>),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">content_body=</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">content =</span> imgfile,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">type    =</span> <span class="st">&quot;imagefile&quot;</span>)))</span></code></pre></div>
</div>
<div id="adding-tables" class="section level4">
<h4>Adding tables</h4>
<p>First we’re going to add a table using the built in Office tables.
The content is stored in <code>tco</code> and can be added to any
placeholder as long as we specify the type as <code>&quot;table&quot;</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_add_slide</span>(cfg, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">template =</span> <span class="st">&quot;content_text&quot;</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">elements =</span> <span class="fu">list</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">title=</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">content =</span> <span class="st">&quot;Tables: Office&quot;</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">type    =</span> <span class="st">&quot;text&quot;</span>),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">sub_title=</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">content =</span> <span class="st">&quot;Table in native Office format&quot;</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">type    =</span> <span class="st">&quot;text&quot;</span>),</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">content_body=</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">content =</span> tco,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">type    =</span> <span class="st">&quot;table&quot;</span>)))</span></code></pre></div>
<p>Similarly, you can add a <code>flextable</code> using the
<code>onbrand</code> abstraction by specifying the type as
<code>&quot;flextable&quot;</code> and supply the correctly formatted content
created above (<code>tcf</code>).</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_add_slide</span>(cfg, </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">template =</span> <span class="st">&quot;content_text&quot;</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">elements =</span> <span class="fu">list</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">title=</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">content =</span> <span class="st">&quot;Tables: flextable&quot;</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">type    =</span> <span class="st">&quot;text&quot;</span>),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">sub_title=</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">content =</span> <span class="st">&quot;Flextables using onbrand abstraction&quot;</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">type    =</span> <span class="st">&quot;text&quot;</span>),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">content_body=</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">content =</span> tcf,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">type    =</span> <span class="st">&quot;flextable&quot;</span>)))</span></code></pre></div>
<p>Lastly, you can create a <code>flextable</code> directly. This gives
you a lot of control with regards to formatting. You simply need to
specify the type as <code>&quot;flextable_object&quot;</code> and provide an
object created with <code>flextable</code> (<code>tfo</code>).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_add_slide</span>(cfg, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">template =</span> <span class="st">&quot;content_text&quot;</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">elements =</span> <span class="fu">list</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">title=</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">content =</span> <span class="st">&quot;Tables: flextable object&quot;</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">type    =</span> <span class="st">&quot;text&quot;</span>),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">sub_title=</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">content =</span> <span class="st">&quot;Flextables using a user-created flextable object&quot;</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">type    =</span> <span class="st">&quot;text&quot;</span>),</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">content_body=</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">content =</span> tfo,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">type    =</span> <span class="st">&quot;flextable_object&quot;</span>)))</span></code></pre></div>
<p>The rest of the reporting script
(<code>make_report_PowerPoint.R</code>) simply provides examples of the
other available slide templates. You can look through those to see if
they are suitable for your needs. If they are not and you need other
templates or wish to create a template for your school or organization,
jump down to the section on custom organizational templates.</p>
</div>
<div id="saving-the-report" class="section level4">
<h4>Saving the report</h4>
<p>Once you’re done you can then save the presentation to a file:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system_rpt_save_report</span>(cfg, <span class="at">output_file =</span> <span class="st">&quot;example.pptx&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>
<div id="word-reports-make_report_word.r" class="section level2">
<h2>Word reports (<code>make_report_Word.R</code>)</h2>
<div id="creating-some-content-1" class="section level3">
<h3>Creating some content</h3>
<p>Just like the PowerPoint example above, we need to create some
content for Word reporting. We’re using wrappers here for
<code>onbrand</code> functions so document content needs to be provided
in a specific format documented in the help for
<code>onbrand::report_add_doc_content()</code></p>
<p>Text formatting can be plain text, formatted as Markdown, or
formatted using the <code>officer::fpar()</code> command.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>plain_text_content <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">rep</span>(<span class="st">&quot;The quick brown fox jumped over the lazy dog.&quot;</span>, <span class="dv">70</span>), <span class="at">collapse=</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>md_text_content    <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">rep</span>(<span class="st">&quot;The *quick* &lt;color:brown&gt;brown&lt;/color&gt; fox **jumped** over the ~lazy dog~.&quot;</span>, <span class="dv">70</span>), <span class="at">collapse=</span><span class="st">&quot; &quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>fpar_text_content  <span class="ot">=</span> officer<span class="sc">::</span><span class="fu">fpar</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>   officer<span class="sc">::</span><span class="fu">ftext</span>(<span class="st">&quot;The quick &quot;</span>, <span class="at">prop=</span><span class="cn">NULL</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>   officer<span class="sc">::</span><span class="fu">ftext</span>(<span class="st">&quot;brown&quot;</span>, <span class="at">prop=</span>officer<span class="sc">::</span><span class="fu">fp_text</span>(<span class="at">color=</span><span class="st">&quot;brown&quot;</span>)),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>   officer<span class="sc">::</span><span class="fu">ftext</span>(<span class="st">&quot; fox jumped over the lazy dog.&quot;</span>, <span class="at">prop=</span><span class="cn">NULL</span>))</span></code></pre></div>
<p>For figures we can use two formats a ggplot object (<code>p</code>)
or an image file (<code>imgfile</code>) these are packed into content
lists <code>gpc</code> and <code>ifc</code>, respectively.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">0</span>, <span class="at">label =</span> <span class="st">&quot;picture example&quot;</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>imgfile <span class="ot">=</span> <span class="fu">tempfile</span>(<span class="at">pattern=</span><span class="st">&quot;image&quot;</span>, <span class="at">fileext=</span><span class="st">&quot;.png&quot;</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename=</span>imgfile, <span class="at">plot=</span>p, <span class="at">height=</span><span class="fl">5.15</span>, <span class="at">width=</span><span class="dv">9</span>, <span class="at">units=</span><span class="st">&quot;in&quot;</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>gpc <span class="ot">=</span> <span class="fu">list</span>(<span class="at">image   =</span> p,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">caption =</span> <span class="st">&quot;This is an example of an image from a ggplot object.&quot;</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>ifc  <span class="ot">=</span> <span class="fu">list</span>(<span class="at">image   =</span> imgfile,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">caption =</span> <span class="st">&quot;This is an example of an image from a file.&quot;</span>)</span></code></pre></div>
<p>The same tabular data from before is used here as well:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tdata <span class="ot">=</span>  <span class="fu">data.frame</span>(<span class="at">Parameters =</span> <span class="fu">c</span>(<span class="st">&quot;Vp&quot;</span>, <span class="st">&quot;Cl&quot;</span>, <span class="st">&quot;Q&quot;</span>, <span class="st">&quot;Vt&quot;</span>),</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Values     =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Units      =</span> <span class="fu">c</span>(<span class="st">&quot;L&quot;</span>, <span class="st">&quot;L/hr&quot;</span>, <span class="st">&quot;L/hr&quot;</span>, <span class="st">&quot;L&quot;</span>) )</span></code></pre></div>
<p><strong>Office table</strong></p>
<p>The content for tables in Office format is similar but it has other
elements as well such as a figure caption:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>tco  <span class="ot">=</span> <span class="fu">list</span>(<span class="at">table     =</span> tdata,    <span class="co"># This element contains the table data</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">header    =</span> <span class="cn">TRUE</span>,     <span class="co"># These two lines control the header</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">first_row =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">caption   =</span> <span class="st">&quot;This creates a table using an Office theme/format.&quot;</span>)</span></code></pre></div>
<p><strong><code>flextable</code> using <code>onbrand</code>
abstraction</strong></p>
<p>Similarly we can create a <code>flextable</code> using the
<code>onbrand</code> abstraction. In this case we’re supplying a caption
and specifying the format of the caption is Markdown
(<code>&quot;md&quot;</code>).</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tcf <span class="ot">=</span> <span class="fu">list</span>(<span class="at">table       =</span> tdata,             <span class="co"># This element contains the table data</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">caption_format =</span> <span class="st">&quot;md&quot;</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">caption     =</span> <span class="st">&quot;This creates a &lt;ff:courier&gt;flextable&lt;/ff&gt; using the &lt;ff:courier&gt;onbrand&lt;/ff&gt; abstraction&quot;</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">header_top  =</span> <span class="fu">list</span>(              <span class="co"># Defining the table headers</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">Parameters =</span> <span class="st">&quot;Name&quot;</span>,  </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">Values     =</span> <span class="st">&quot;Value&quot;</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">Units      =</span> <span class="st">&quot;Units&quot;</span>),</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">cwidth         =</span> <span class="fl">0.8</span>,            <span class="co"># Column width</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">table_autofit  =</span> <span class="cn">TRUE</span>,           <span class="co"># Making the tables automatically fit</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">table_theme    =</span> <span class="st">&quot;theme_zebra&quot;</span>,  <span class="co"># Making the tables automatically fit</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">first_row =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><strong>User-defined <code>flextable</code> object</strong></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>tfo <span class="ot">=</span> flextable<span class="sc">::</span><span class="fu">flextable</span>(tdata)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>tfo <span class="ot">=</span> flextable<span class="sc">::</span><span class="fu">autofit</span>(tfo)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>tcfo <span class="ot">=</span> <span class="fu">list</span>(<span class="at">ft =</span> tfo,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">caption  =</span> <span class="st">&quot;This inserts a flextable object created by the user&quot;</span>)</span></code></pre></div>
</div>
<div id="creating-a-new-report-1" class="section level3">
<h3>Creating a new report</h3>
<p>We create a new Word report by defining the template option as
<code>&quot;Word&quot;</code>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_read_template</span>(cfg, <span class="st">&quot;Word&quot;</span>)</span></code></pre></div>
</div>
<div id="adding-content-to-the-report" class="section level3">
<h3>Adding content to the report</h3>
<p>Content is added using
<code>ubiquity::system_rpt_add_doc_content()</code> with the content and
type of content specified. This wraps around the
<code>onbrand::report_add_doc_content()</code> function. See the help
for that function for allowed types and the expected format of the
content. Below we will cover some examples of common content to be
added.</p>
<div id="adding-text" class="section level4">
<h4>Adding text</h4>
<p>Text content contains a <code>style</code> element where you can
specify the <code>onbrand</code> style.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_add_doc_content</span>(cfg, </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">type=</span><span class="st">&quot;text&quot;</span>,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">content =</span> <span class="fu">list</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">&quot;Heading_1&quot;</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">text  =</span> <span class="st">&quot;Formatting Text&quot;</span>))</span></code></pre></div>
<p>To get a list of available styles for a given template you can use
<code>system_rpt_template_details()</code>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>fr <span class="ot">=</span> <span class="fu">system_rpt_template_details</span>(cfg)</span></code></pre></div>
<p>This will produce output in the console like the following:</p>
<pre><code>## Mapping:     /Users/jmh/Library/R/x86_64/4.1/library/ubiquity/ubinc/templates/report.yaml
## Report Type: Word
##   onbrand style (word style, style type)
##   --------------------------------------
##   Code (Code, paragraph)
##   Figure_Caption (graphic title, paragraph)
##   Heading_1 (heading 1, paragraph)
##   Heading_2 (heading 2, paragraph)
##   Heading_3 (heading 3, paragraph)
##   Normal (Normal, paragraph)
##   Notes (Notes, paragraph)
##   Table_Caption (table title, paragraph)
##   TOC (toc 1, paragraph)
##   Table (Table Grid, table)</code></pre>
<p>Text can be added in three different formats: plain text, as
Markdown, and using the <code>officer::fpar()</code> command from the
<code>officer</code> package.</p>
<p><strong>Plain text</strong></p>
<p>If no <code>style</code> is specified a template default style will
be used.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_add_doc_content</span>(cfg, </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">type=</span><span class="st">&quot;text&quot;</span>,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">content =</span> <span class="fu">list</span>(</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">text  =</span> plain_text_content))</span></code></pre></div>
<p><strong>Markdown</strong></p>
<p>To add text content other than plain text you need to add a
<code>format</code> element. For example you can supply text in Markdown
format and then define the <code>format</code> as <code>&quot;md&quot;</code>. For
details on Markdown supported see the help for the
<code>onbrand::md_to_officer()</code> function.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_add_doc_content</span>(cfg, </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">type=</span><span class="st">&quot;text&quot;</span>,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">content =</span> <span class="fu">list</span>(</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style  =</span> <span class="st">&quot;Normal&quot;</span>,    </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">format =</span> <span class="st">&quot;md&quot;</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">text   =</span> md_text_content))</span></code></pre></div>
<p><strong>Using <code>officer::fpar()</code></strong></p>
<p>Officer formats text using the <code>officer::fpar()</code> command.
If you have an <code>fpar</code> object you can use that as the
<code>text</code> element for the content. You just need to specify the
<code>format</code> as <code>&quot;fpar&quot;</code>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_add_doc_content</span>(cfg, </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">type=</span><span class="st">&quot;text&quot;</span>,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">content =</span> <span class="fu">list</span>(</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style  =</span> <span class="st">&quot;Normal&quot;</span>,    </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">format =</span> <span class="st">&quot;fpar&quot;</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">text   =</span> fpar_text_content))</span></code></pre></div>
</div>
<div id="adding-figures-1" class="section level4">
<h4>Adding figures</h4>
<p>To add figures you can specify the type as either an
<code>&quot;imagefile&quot;</code> or <code>&quot;ggplot&quot;</code>:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_add_doc_content</span>(cfg,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">type     =</span> <span class="st">&quot;imagefile&quot;</span>,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">content  =</span> ifc)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_add_doc_content</span>(cfg,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type     =</span> <span class="st">&quot;ggplot&quot;</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">content  =</span> gpc)</span></code></pre></div>
</div>
<div id="adding-tables-1" class="section level4">
<h4>Adding tables</h4>
<p>Tables can be added in Office table, <code>onbrand</code> abstraction
of flextables, and as flextable objects. This is done by using the type
<code>&quot;table&quot;</code>, <code>&quot;flextable&quot;</code>, and
<code>&quot;flextable_object&quot;</code> respectively:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_add_doc_content</span>(cfg, </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">type     =</span> <span class="st">&quot;table&quot;</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">content  =</span> tco)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_add_doc_content</span>(cfg, </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type     =</span> <span class="st">&quot;flextable&quot;</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">content  =</span> tcf)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_add_doc_content</span>(cfg, </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">type     =</span> <span class="st">&quot;flextable_object&quot;</span>,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">content  =</span> tcfo)</span></code></pre></div>
</div>
<div id="other-content-and-formatting" class="section level4">
<h4>Other content and formatting</h4>
<p>For information on adding other content (such as using placeholder
text within a document) and formatting (number of columns, page
orientation, etc) see the function
<code>onbrand::report_add_doc_content()</code> for a list of allowed
<code>type</code> values and the expected <code>content</code>
format.</p>
</div>
<div id="saving-the-report-1" class="section level4">
<h4>Saving the report</h4>
<p>Once you’re done you can then save the document to a file:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system_rpt_save_report</span>(cfg, <span class="at">output_file =</span> <span class="st">&quot;example.docx&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>
<div id="using-custom-organizational-templates" class="section level2">
<h2>Using custom organizational templates</h2>
<p>Internally <code>ubiquity</code> uses the <code>onbrand</code>
package for customizable templates. To create a template for your
organization you should use the <code>onbrand</code> vignette for <a href="https://onbrand.ubiquity.tools/articles/Custom_Office_Templates.html">Custom
Templates</a>. This will instruct you to create a yaml mapping file for
your templates. You can use the built in organizational template as a
starting point for that:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>tr <span class="ot">=</span> <span class="fu">system_fetch_template</span>(cfg, <span class="at">template=</span><span class="st">&quot;myOrg&quot;</span>)</span></code></pre></div>
<p>In order to use the <code>ubiquity</code> workflows, you will need to
have specific placeholders for PowerPoint and styles for Word. You can
have others, but you will at least need those listed below. These should
already be defined in the organizational template. You simply need to
ensure that the placeholder names and content types from PowerPoint are
correct and that the style names in Word you create are also assigned to
the correct <code>onbrand</code> styles.</p>
<div id="powerpoint" class="section level3">
<h3>PowerPoint</h3>
<p>In PowerPoint you will need to have a document template with the
following slide masters/templates. You will need to name the slide
Master the name shown in the table below. For each slide master you will
need to create placeholders for the specified content. Make sure the
content type matches that shown below. When you create the
<code>onbrand</code> mapping file you will need to use the placeholder
names shown below.</p>
<div class="tabwid"><style>.cl-d7c98ad6{}.cl-d7c66fa4{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d7c66fae{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d7c7b8e6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d7c7c08e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7c7c08f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7c7c0ac{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-d7c98ad6"><thead><tr style="overflow-wrap:break-word;"><th class="cl-d7c7c08e"><p class="cl-d7c7b8e6">Master/Template</p></th><th class="cl-d7c7c08e"><p class="cl-d7c7b8e6">onbrand</p></th><th class="cl-d7c7c08e"><p class="cl-d7c7b8e6">Content</p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-d7c7c08e"><p class="cl-d7c7b8e6">Name</p></th><th class="cl-d7c7c08e"><p class="cl-d7c7b8e6">Placeholder</p></th><th class="cl-d7c7c08e"><p class="cl-d7c7b8e6">Type</p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td rowspan="2" class="cl-d7c7c08f"><p class="cl-d7c7b8e6">title_slide</p></td><td class="cl-d7c7c08f"><p class="cl-d7c7b8e6">title</p></td><td class="cl-d7c7c08f"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">sub_title</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="2" class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">section_slide</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">title</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">sub_title</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">title_only</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">title</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="3" class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">content_text</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">title</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">sub_title</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">content_body</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="3" class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">content_list</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">title</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">sub_title</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">content_body</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">list</p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="6" class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">two_content_header_list</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">title</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">sub_title</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">content_left_header</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">content_left</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">list</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">content_right_header</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">content_right</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">list</p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="6" class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">two_content_header_text</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">title</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">sub_title</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">content_left_header</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">content_left</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">content_right_header</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">content_right</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="4" class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">two_content_list</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">title</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">sub_title</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">content_left</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">list</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">content_right</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">list</p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="4" class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">two_content_text</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">title</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">sub_title</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">content_left</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">content_right</p></td><td class="cl-d7c7c0ac"><p class="cl-d7c7b8e6">text</p></td></tr></tbody></table></div>
</div>
<div id="word" class="section level3">
<h3>Word</h3>
<p>For Word reporting you will need to have a Word template with the
following styles defined. When you create the <code>onbrand</code>
mapping file you will need to use the onbrand Style name listed.</p>
<div class="tabwid"><style>.cl-d7cf0a4c{}.cl-d7cbad34{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d7cbad3e{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d7ccdcf4{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d7cce528{width:1.33in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7cce529{width:1.066in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7cce532{width:0.982in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7cce533{width:1.33in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7cce534{width:1.066in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7cce53c{width:0.982in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7cce53d{width:1.33in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7cce546{width:1.066in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7cce547{width:0.982in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7cce548{width:1.33in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7cce549{width:1.066in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7cce550{width:0.982in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7cce551{width:1.33in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7cce552{width:1.066in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7cce55a{width:0.982in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7cce55b{width:1.33in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7cce55c{width:1.066in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7cce564{width:0.982in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-d7cf0a4c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-d7cce528"><p class="cl-d7ccdcf4">onbrand</p></th><th class="cl-d7cce529"><p class="cl-d7ccdcf4">Word</p></th><th class="cl-d7cce532"><p class="cl-d7ccdcf4">Style</p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-d7cce528"><p class="cl-d7ccdcf4">Style</p></th><th class="cl-d7cce529"><p class="cl-d7ccdcf4">Style</p></th><th class="cl-d7cce532"><p class="cl-d7ccdcf4">Type</p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-d7cce533"><p class="cl-d7ccdcf4">Code</p></td><td class="cl-d7cce534"><p class="cl-d7ccdcf4">Code</p></td><td class="cl-d7cce53c"><p class="cl-d7ccdcf4">paragraph</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7cce53d"><p class="cl-d7ccdcf4">Figure_Caption</p></td><td class="cl-d7cce546"><p class="cl-d7ccdcf4">graphic title</p></td><td class="cl-d7cce547"><p class="cl-d7ccdcf4">paragraph</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7cce548"><p class="cl-d7ccdcf4">Heading_1</p></td><td class="cl-d7cce549"><p class="cl-d7ccdcf4">heading 1</p></td><td class="cl-d7cce550"><p class="cl-d7ccdcf4">paragraph</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7cce548"><p class="cl-d7ccdcf4">Heading_2</p></td><td class="cl-d7cce549"><p class="cl-d7ccdcf4">heading 2</p></td><td class="cl-d7cce550"><p class="cl-d7ccdcf4">paragraph</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7cce548"><p class="cl-d7ccdcf4">Heading_3</p></td><td class="cl-d7cce549"><p class="cl-d7ccdcf4">heading 3</p></td><td class="cl-d7cce550"><p class="cl-d7ccdcf4">paragraph</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7cce548"><p class="cl-d7ccdcf4">Normal</p></td><td class="cl-d7cce549"><p class="cl-d7ccdcf4">Normal</p></td><td class="cl-d7cce550"><p class="cl-d7ccdcf4">paragraph</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7cce548"><p class="cl-d7ccdcf4">Notes</p></td><td class="cl-d7cce549"><p class="cl-d7ccdcf4">Notes</p></td><td class="cl-d7cce550"><p class="cl-d7ccdcf4">paragraph</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7cce551"><p class="cl-d7ccdcf4">Table_Caption</p></td><td class="cl-d7cce552"><p class="cl-d7ccdcf4">table title</p></td><td class="cl-d7cce55a"><p class="cl-d7ccdcf4">paragraph</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7cce548"><p class="cl-d7ccdcf4">TOC</p></td><td class="cl-d7cce549"><p class="cl-d7ccdcf4">toc 1</p></td><td class="cl-d7cce550"><p class="cl-d7ccdcf4">paragraph</p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d7cce55b"><p class="cl-d7ccdcf4">Table</p></td><td class="cl-d7cce55c"><p class="cl-d7ccdcf4">Table Grid</p></td><td class="cl-d7cce564"><p class="cl-d7ccdcf4">table</p></td></tr></tbody></table></div>
</div>
<div id="using-the-custom-templates" class="section level3">
<h3>Using the custom templates</h3>
<p>To use the custom templates you would use
<code>system_rpt_read_template()</code> and specify the mapping file and
the Office document containing your template. For example if you wanted
to load a PowerPoint template called <code>myOrg.pptx</code> and your
yaml mapping file was called <code>myOrg.yaml</code> you would use the
following:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_read_template</span>(cfg, </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">mapping  =</span> <span class="st">&quot;myOrg.yaml&quot;</span>,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">template =</span> <span class="st">&quot;myOrg.pptx&quot;</span>)</span></code></pre></div>
<p>After that you can just use all the normal reporting functions to add
content to the report.</p>
</div>
</div>
<div id="integration-with-ubiquity-workflows" class="section level2">
<h2>Integration with <code>ubiquity</code> workflows</h2>
<div id="parameter-estimation" class="section level3">
<h3>Parameter estimation</h3>
<p>After performing a parameter estimation and archiving the estimation
with a specified analysis name, that analysis name can be used to
retrieve the results and append them to an open report using
<code>system_rpt_estimation()</code>. This function supports both
PowerPoint and Word reports.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_estimation</span>(<span class="at">cfg=</span>cfg, <span class="at">analysis_name=</span><span class="st">&quot;analysis_name&quot;</span>)</span></code></pre></div>
</div>
<div id="non-compartmental-analysis-nca" class="section level3">
<h3>Non-compartmental analysis (NCA)</h3>
<p>The results of NCA can be appended to a report using the
<code>system_rpt_nca()</code> function and supplying the NCA analysis
name. This function supports both PowerPoint and Word reports.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_rpt_nca</span>(<span class="at">cfg=</span>cfg, <span class="at">analysis_name=</span><span class="st">&quot;analysis_name&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="modifying-reports-directly-with-officer" class="section level2">
<h2>Modifying reports directly with <code>officer</code></h2>
<p>Sometimes the functions provided above are not sufficient to get what
you want done. It may be more convenient to directly use the
<code>officer</code> functions to add content or modify your report. If
you have report initialized, you can pull that report out of the
ubiquity system object using
<code>system_fetch_rpt_officer_object()</code>:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>rpt <span class="ot">=</span> <span class="fu">system_fetch_rpt_officer_object</span>(cfg)</span></code></pre></div>
<p>Now <code>rpt</code> is an <code>officer</code> object. If it
contains a PowerPoint presentation you can use all of the
<code>officer</code> functions for PowerPoint to modify that object. If
it’s a Word document you can use the Word functions from
<code>officer</code> to modify/add content. Once you’re done making
changes you can put the object back using
<code>system_set_rpt_officer_object()</code>:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>cfg  <span class="ot">=</span> <span class="fu">system_set_rpt_officer_object</span>(cfg, rpt)</span></code></pre></div>
<p>Then you can continue using the ubiquity functions above or save the
document.</p>
</div>
<div id="wrapper-mapping-between-ubiquity-and-onbrand-functions" class="section level2">
<h2>Wrapper mapping between <code>ubiquity</code> and
<code>onbrand</code> functions</h2>
<table>
<colgroup>
<col width="46%" />
<col width="53%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><code>ubiquity</code></th>
<th align="left"><code>onbrand</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>system_rpt_read_template()</code></td>
<td align="left"><code>onbrand::read_template()</code></td>
</tr>
<tr class="even">
<td align="left"><code>system_rpt_read_template()</code></td>
<td align="left"><code>onbrand::read_template()</code></td>
</tr>
<tr class="odd">
<td align="left"><code>system_rpt_add_slide()</code></td>
<td align="left"><code>onbrand::report_add_slide()</code></td>
</tr>
<tr class="even">
<td align="left"><code>system_rpt_add_doc_content()</code></td>
<td align="left"><code>onbrand::report_add_doc_content()</code></td>
</tr>
<tr class="odd">
<td align="left"><code>system_rpt_save_report()</code></td>
<td align="left"><code>onbrand::save_report()</code></td>
</tr>
<tr class="even">
<td align="left"><code>system_rpt_template_details()</code></td>
<td align="left"><code>onbrand::template_details()</code></td>
</tr>
<tr class="odd">
<td align="left"><code>system_fetch_rpt_officer_object()</code></td>
<td align="left"><code>onbrand::fetch_officer_object()</code></td>
</tr>
<tr class="even">
<td align="left"><code>system_set_rpt_officer_object()</code></td>
<td align="left"><code>onbrand::set_officer_object()</code></td>
</tr>
</tbody>
</table>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
